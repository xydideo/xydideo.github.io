{"title":"常用过滤器","date":"2020-07-10T03:11:30.000Z","date_formatted":{"ll":"Jul 10, 2020","L":"07/10/2020","MM-DD":"07-10"},"link":"2020/07/10/filters","tags":["filter","javascript"],"categories":["开发"],"updated":"2020-07-10T03:19:08.724Z","content":"<h2 id=\"常用过滤器整理\">常用过滤器整理<a href=\"#常用过滤器整理\" title=\"常用过滤器整理\"></a></h2><br><p>文件挂载：<code>filters.js</code></p>\n<h5 id=\"时间格式转换\">时间格式转换<a href=\"#时间格式转换\" title=\"时间格式转换\"></a></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export function parseTime(time, cFormat) &#123;</span><br><span class=\"line\">  if (time) &#123;</span><br><span class=\"line\">    if (arguments.length &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class=\"line\">      return null</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    const format &#x3D; cFormat || &quot;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&quot;</span><br><span class=\"line\">    let date</span><br><span class=\"line\">    if (typeof time &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;</span><br><span class=\"line\">      date &#x3D; time</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">      if ((typeof time &#x3D;&#x3D;&#x3D; &quot;string&quot;) &amp;&amp; (&#x2F;^[0-9]+$&#x2F;.test(time))) &#123;</span><br><span class=\"line\">        time &#x3D; parseInt(time)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      if ((typeof time &#x3D;&#x3D;&#x3D; &quot;number&quot;) &amp;&amp; (time.toString().length &#x3D;&#x3D;&#x3D; 10)) &#123;</span><br><span class=\"line\">        time &#x3D; time * 1000</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      date &#x3D; new Date(time)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    const formatObj &#x3D; &#123;</span><br><span class=\"line\">      y: date.getFullYear(),</span><br><span class=\"line\">      m: date.getMonth() + 1,</span><br><span class=\"line\">      d: date.getDate(),</span><br><span class=\"line\">      h: date.getHours(),</span><br><span class=\"line\">      i: date.getMinutes(),</span><br><span class=\"line\">      s: date.getSeconds(),</span><br><span class=\"line\">      a: date.getDay()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    const time_str &#x3D; format.replace(&#x2F;&#123;([ymdhisa])+&#125;&#x2F;g, (result, key) &#x3D;&gt; &#123;</span><br><span class=\"line\">      const value &#x3D; formatObj[key]</span><br><span class=\"line\">      &#x2F;&#x2F; Note: getDay() returns 0 on Sunday</span><br><span class=\"line\">      if (key &#x3D;&#x3D;&#x3D; &quot;a&quot;) &#123; return [&quot;日&quot;, &quot;一&quot;, &quot;二&quot;, &quot;三&quot;, &quot;四&quot;, &quot;五&quot;, &quot;六&quot;][value] &#125;</span><br><span class=\"line\">      return value.toString().padStart(2, &quot;0&quot;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    return time_str</span><br><span class=\"line\">  &#125; else &#123;</span><br><span class=\"line\">    return &quot;&quot;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">使用：&#x2F;&#x2F;</span><br></pre></td></tr></table></figure><br><h5 id=\"时间计算\">时间计算<a href=\"#时间计算\" title=\"时间计算\"></a></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export function formatTime(time, option) &#123;</span><br><span class=\"line\">  if ((&quot;&quot; + time).length &#x3D;&#x3D;&#x3D; 10) &#123;</span><br><span class=\"line\">    time &#x3D; parseInt(time) * 1000</span><br><span class=\"line\">  &#125; else &#123;</span><br><span class=\"line\">    time &#x3D; +time</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  const d &#x3D; new Date(time)</span><br><span class=\"line\">  const now &#x3D; Date.now()</span><br><span class=\"line\"></span><br><span class=\"line\">  const diff &#x3D; (now - d) &#x2F; 1000</span><br><span class=\"line\"></span><br><span class=\"line\">  if (diff &lt; 30) &#123;</span><br><span class=\"line\">    return &quot;刚刚&quot;</span><br><span class=\"line\">  &#125; else if (diff &lt; 3600) &#123;</span><br><span class=\"line\">    &#x2F;&#x2F; less 1 hour</span><br><span class=\"line\">    return Math.ceil(diff &#x2F; 60) + &quot;分钟前&quot;</span><br><span class=\"line\">  &#125; else if (diff &lt; 3600 * 24) &#123;</span><br><span class=\"line\">    return Math.ceil(diff &#x2F; 3600) + &quot;小时前&quot;</span><br><span class=\"line\">  &#125; else if (diff &lt; 3600 * 24 * 2) &#123;</span><br><span class=\"line\">    return &quot;1天前&quot;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  if (option) &#123;</span><br><span class=\"line\">    return parseTime(time, option)</span><br><span class=\"line\">  &#125; else &#123;</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      d.getMonth() +</span><br><span class=\"line\">      1 +</span><br><span class=\"line\">      &quot;月&quot; +</span><br><span class=\"line\">      d.getDate() +</span><br><span class=\"line\">      &quot;日&quot; +</span><br><span class=\"line\">      d.getHours() +</span><br><span class=\"line\">      &quot;时&quot; +</span><br><span class=\"line\">      d.getMinutes() +</span><br><span class=\"line\">      &quot;分&quot;</span><br><span class=\"line\">    )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><h5 id=\"金额数字格式\">金额数字格式<a href=\"#金额数字格式\" title=\"金额数字格式\"></a></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export function toThousandFilter(num) &#123;</span><br><span class=\"line\">  return (+num || 0).toString().replace(&#x2F;^-?\\d+&#x2F;g, m &#x3D;&gt; m.replace(&#x2F;(?&#x3D;(?!\\b)(\\d&#123;3&#125;)+$)&#x2F;g, &quot;,&quot;))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br><h5 id=\"手机号码脱敏\">手机号码脱敏<a href=\"#手机号码脱敏\" title=\"手机号码脱敏\"></a></h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export function mobile(tel) &#123;</span><br><span class=\"line\">  return String(tel).substr(0, 3) + &quot;****&quot; + String(tel).substr(7, 4)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","next":{"title":"常用公共方法","link":"2020/07/10/function"},"plink":"http://yoursite.com/2020/07/10/filters/","toc":[{"id":"常用过滤器整理","title":"常用过滤器整理","index":"1"}]}